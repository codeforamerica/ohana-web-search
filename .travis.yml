language: ruby
bundler_args: "--without development:production"
cache: bundler
sudo: false
before_install:
- gem update --system
# Install PhantomJS 2.1.1 manually
- "export PHANTOMJS_VERSION=2.1.1"
- "phantomjs --version"
- "export PATH=$PWD/travis_phantomjs/phantomjs-$PHANTOMJS_VERSION-linux-x86_64/bin:$PATH"
- "phantomjs --version"
- "if [ $(phantomjs --version) != '$PHANTOMJS_VERSION' ]; then rm -rf $PWD/travis_phantomjs; mkdir -p $PWD/travis_phantomjs; fi"
- "if [ $(phantomjs --version) != '$PHANTOMJS_VERSION' ]; then wget https://github.com/Medium/phantomjs/releases/download/v$PHANTOMJS_VERSION/phantomjs-$PHANTOMJS_VERSION-linux-x86_64.tar.bz2 -O $PWD/travis_phantomjs/phantomjs-$PHANTOMJS_VERSION-linux-x86_64.tar.bz2; fi"
- "if [ $(phantomjs --version) != '$PHANTOMJS_VERSION' ]; then tar -xvf $PWD/travis_phantomjs/phantomjs-$PHANTOMJS_VERSION-linux-x86_64.tar.bz2 -C $PWD/travis_phantomjs; fi"
- "phantomjs --version"
script: bundle exec rspec
rvm:
- 2.3.3
deploy:
  provider: heroku
  app: ohana-staging
  strategy: git
  api_key:
    secure: aChobDF6Mbja08bZbo2AOj6/nF0BVoHVcnfmYwRMnIqq4s/3tXQy5B/eefkR1KgTiTpBym6Bp9d52ovQON1JW7J0nc2pHsQcggrcgsf5MWrYSxeqdvDGaOAQ993cBCBlhfTyaGYlHq/yQO6MTEZHQY+6oppLvV9DQstvJEYXqBw=
env:
  global:
  - OHANA_API_ENDPOINT=http://smc-ohana-api-test.herokuapp.com/api
  - DOMAIN_NAME=lvh.me
